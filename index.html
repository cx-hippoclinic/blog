<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/blog/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/blog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/blog/css/style.css">

  
    
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-v-model" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/12/21/v-model/" class="article-date">
  <time class="dt-published" datetime="2021-12-21T14:17:22.000Z" itemprop="datePublished">2021-12-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/12/21/v-model/">v-model</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>面试题：请阐述一下 <code>v-model</code> 的原理</p>
</blockquote>
<p><code>v-model</code>即可以作用于表单元素，又可作用于自定义组件，无论是哪一种情况，它都是一个语法糖，最终会生成一个属性和一个事件</p>
<p><strong>当其作用于表单元素时</strong>，<code>vue</code>会根据作用的表单元素类型而生成合适的属性和事件。例如，作用于普通文本框的时候，它会生成<code>value</code>属性和<code>input</code>事件，而当其作用于单选框或多选框时，它会生成<code>checked</code>属性和<code>change</code>事件。</p>
<p><code>v-model</code>也可作用于自定义组件，<strong>当其作用于自定义组件时</strong>，默认情况下，它会生成一个<code>value</code>属性和<code>input</code>事件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Comp</span> <span class="attr">v-model</span>=<span class="string">&quot;data&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 等效于 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Comp</span> <span class="attr">:value</span>=<span class="string">&quot;data&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;data=$event&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>开发者可以通过组件的<code>model</code>配置来改变生成的属性和事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comp</span></span><br><span class="line"><span class="keyword">const</span> Comp = &#123;</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: <span class="string">&quot;number&quot;</span>, <span class="comment">// 默认为 value</span></span><br><span class="line">    event: <span class="string">&quot;change&quot;</span> <span class="comment">// 默认为 input</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Comp</span> <span class="attr">v-model</span>=<span class="string">&quot;data&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 等效于 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Comp</span> <span class="attr">:number</span>=<span class="string">&quot;data&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;data=$event&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/21/v-model/" data-id="ckxg6yzfd00004gv7d2e058qr" data-title="v-model" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-虚拟dom详解" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/12/21/%E8%99%9A%E6%8B%9Fdom%E8%AF%A6%E8%A7%A3/" class="article-date">
  <time class="dt-published" datetime="2021-12-21T14:07:00.000Z" itemprop="datePublished">2021-12-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/12/21/%E8%99%9A%E6%8B%9Fdom%E8%AF%A6%E8%A7%A3/">虚拟dom详解</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>面试题：请你阐述一下对vue虚拟dom的理解</p>
</blockquote>
<ol>
<li><p>什么是虚拟dom？</p>
<p>虚拟dom本质上就是一个普通的JS对象，用于描述视图的界面结构</p>
<p>在vue中，每个组件都有一个<code>render</code>函数，每个<code>render</code>函数都会返回一个虚拟dom树，这也就意味着每个组件都对应一棵虚拟DOM树</p>
<img src="http://mdrs.yuanjin.tech/img/20210225140726.png" alt="image-20210225140726003" style="zoom:30%;" align="left" />
</li>
<li><p>为什么需要虚拟dom？</p>
<p>在<code>vue</code>中，渲染视图会调用<code>render</code>函数，这种渲染不仅发生在组件创建时，同时发生在视图依赖的数据更新时。如果在渲染时，直接使用真实<code>DOM</code>，由于真实<code>DOM</code>的创建、更新、插入等操作会带来大量的性能损耗，从而就会极大的降低渲染效率。</p>
<p>因此，<code>vue</code>在渲染时，使用虚拟dom来替代真实dom，主要为解决渲染效率的问题。</p>
</li>
<li><p>虚拟dom是如何转换为真实dom的？</p>
<p>在一个组件实例首次被渲染时，它先生成虚拟dom树，然后根据虚拟dom树创建真实dom，并把真实dom挂载到页面中合适的位置，此时，每个虚拟dom便会对应一个真实的dom。</p>
<p>如果一个组件受响应式数据变化的影响，需要重新渲染时，它仍然会重新调用render函数，创建出一个新的虚拟dom树，用新树和旧树对比，通过对比，vue会找到最小更新量，然后更新必要的虚拟dom节点，最后，这些更新过的虚拟节点，会去修改它们对应的真实dom</p>
<p>这样一来，就保证了对真实dom达到最小的改动。</p>
<img src="http://mdrs.yuanjin.tech/img/20210225144108.png" alt="image-20210225144108143" style="zoom:33%;" align="left" />
</li>
<li><p>模板和虚拟dom的关系</p>
<p>vue框架中有一个<code>compile</code>模块，它主要负责将模板转换为<code>render</code>函数，而<code>render</code>函数调用后将得到虚拟dom。</p>
<p>编译的过程分两步：</p>
<ol>
<li>将模板字符串转换成为<code>AST</code></li>
<li>将<code>AST</code>转换为<code>render</code>函数</li>
</ol>
<p>如果使用传统的引入方式，则编译时间发生在组件第一次加载时，这称之为运行时编译。</p>
<p>如果是在<code>vue-cli</code>的默认配置下，编译发生在打包时，这称之为模板预编译。</p>
<p>编译是一个极其耗费性能的操作，预编译可以有效的提高运行时的性能，而且，由于运行的时候已不需要编译，<code>vue-cli</code>在打包时会排除掉<code>vue</code>中的<code>compile</code>模块，以减少打包体积</p>
<p>模板的存在，仅仅是为了让开发人员更加方便的书写界面代码</p>
<p><strong>vue最终运行的时候，最终需要的是render函数，而不是模板，因此，模板中的各种语法，在虚拟dom中都是不存在的，它们都会变成虚拟dom的配置</strong></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/21/%E8%99%9A%E6%8B%9Fdom%E8%AF%A6%E8%A7%A3/" data-id="ckxg6lcrh0000mgv78cws3y6e" data-title="虚拟dom详解" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-组件通信" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/12/21/%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/" class="article-date">
  <time class="dt-published" datetime="2021-12-21T14:02:03.000Z" itemprop="datePublished">2021-12-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/12/21/%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/">组件通信</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>面试题：vue组件之间有哪些通信方式？</p>
</blockquote>
<h1 id="父子组件通信"><a href="#父子组件通信" class="headerlink" title="父子组件通信"></a>父子组件通信</h1><blockquote>
<p>绝大部分<code>vue</code>本身提供的通信方式，都是父子组件通信</p>
</blockquote>
<h2 id="prop"><a href="#prop" class="headerlink" title="prop"></a><code>prop</code></h2><p>最常见的组件通信方式之一，由父组件传递到子组件</p>
<h2 id="event"><a href="#event" class="headerlink" title="event"></a><code>event</code></h2><p>最常见的组件通信方式之一，当子组件发生了某些事，可以通过<code>event</code>通知父组件</p>
<h2 id="style和class"><a href="#style和class" class="headerlink" title="style和class"></a><code>style</code>和<code>class</code></h2><p>父组件可以向子组件传递<code>style</code>和<code>class</code>，它们会合并到子组件的根元素中</p>
<p><strong>示例</strong></p>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;HelloWorld</span><br><span class="line">      style&#x3D;&quot;color:red&quot;</span><br><span class="line">      class&#x3D;&quot;hello&quot;</span><br><span class="line">      msg&#x3D;&quot;Welcome to Your Vue.js App&quot;</span><br><span class="line">    &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import HelloWorld from &quot;.&#x2F;components&#x2F;HelloWorld.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    HelloWorld,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;world&quot; style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;HelloWorld&quot;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    msg: String,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>渲染结果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hello world&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:red; text-aling:center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to Your Vue.js App<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="attribute"><a href="#attribute" class="headerlink" title="attribute"></a><code>attribute</code></h2><p>如果父组件传递了一些属性到子组件，但子组件并没有声明这些属性，则它们称之为<code>attribute</code>，这些属性会直接附着在子组件的根元素上</p>
<blockquote>
<p>不包括<code>style</code>和<code>class</code>，它们会被特殊处理</p>
</blockquote>
<p><strong>示例</strong></p>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 除 msg 外，其他均为 attribute --&gt;</span><br><span class="line">    &lt;HelloWorld</span><br><span class="line">      data-a&#x3D;&quot;1&quot;</span><br><span class="line">      data-b&#x3D;&quot;2&quot;</span><br><span class="line">      msg&#x3D;&quot;Welcome to Your Vue.js App&quot;</span><br><span class="line">    &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import HelloWorld from &quot;.&#x2F;components&#x2F;HelloWorld.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    HelloWorld,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;HelloWorld&quot;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    msg: String,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    console.log(this.$attrs); &#x2F;&#x2F; 得到： &#123; &quot;data-a&quot;: &quot;1&quot;, &quot;data-b&quot;: &quot;2&quot; &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>渲染结果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-a</span>=<span class="string">&quot;1&quot;</span> <span class="attr">data-b</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to Your Vue.js App<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>子组件可以通过<code>inheritAttrs: false</code>配置，禁止将<code>attribute</code>附着在子组件的根元素上，但不影响通过<code>$attrs</code>获取</p>
<h2 id="natvie修饰符"><a href="#natvie修饰符" class="headerlink" title="natvie修饰符"></a><code>natvie</code>修饰符</h2><p>在注册事件时，父组件可以使用<code>native</code>修饰符，将事件注册到子组件的根元素上</p>
<p><strong>示例</strong></p>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;HelloWorld @click.native&#x3D;&quot;handleClick&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import HelloWorld from &quot;.&#x2F;components&#x2F;HelloWorld.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    HelloWorld,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      console.log(1);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;Hello World&lt;&#x2F;h1&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>
<p>渲染结果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 点击该 div，会输出 1 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="listeners"><a href="#listeners" class="headerlink" title="$listeners"></a><code>$listeners</code></h2><p>子组件可以通过<code>$listeners</code>获取父组件传递过来的所有事件处理函数</p>
<h2 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a><code>v-model</code></h2><p>后续章节讲解</p>
<h2 id="sync修饰符"><a href="#sync修饰符" class="headerlink" title="sync修饰符"></a><code>sync</code>修饰符</h2><p>和<code>v-model</code>的作用类似，用于双向绑定，不同点在于<code>v-model</code>只能针对一个数据进行双向绑定，而<code>sync</code>修饰符没有限制</p>
<p>示例</p>
<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &lt;button @click&#x3D;&quot;$emit(&#96;update:num1&#96;, num1 - 1)&quot;&gt;-&lt;&#x2F;button&gt;</span><br><span class="line">      &#123;&#123; num1 &#125;&#125;</span><br><span class="line">      &lt;button @click&#x3D;&quot;$emit(&#96;update:num1&#96;, num1 + 1)&quot;&gt;+&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &lt;button @click&#x3D;&quot;$emit(&#96;update:num2&#96;, num2 - 1)&quot;&gt;-&lt;&#x2F;button&gt;</span><br><span class="line">      &#123;&#123; num2 &#125;&#125;</span><br><span class="line">      &lt;button @click&#x3D;&quot;$emit(&#96;update:num2&#96;, num2 + 1)&quot;&gt;+&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;p&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: [&quot;num1&quot;, &quot;num2&quot;],</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;Numbers :num1.sync&#x3D;&quot;n1&quot; :num2.sync&#x3D;&quot;n2&quot; &#x2F;&gt;</span><br><span class="line">    &lt;!-- 等同于 --&gt;</span><br><span class="line">    &lt;Numbers</span><br><span class="line">      :num1&#x3D;&quot;n1&quot;</span><br><span class="line">      @update:num1&#x3D;&quot;n1 &#x3D; $event&quot;</span><br><span class="line">      :num2&#x3D;&quot;n2&quot;</span><br><span class="line">      @update:num2&#x3D;&quot;n2 &#x3D; $event&quot;</span><br><span class="line">    &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Numbers from &quot;.&#x2F;components&#x2F;Numbers.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    Numbers,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      n1: 0,</span><br><span class="line">      n2: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="parent和-children"><a href="#parent和-children" class="headerlink" title="$parent和$children"></a><code>$parent</code>和<code>$children</code></h2><p>在组件内部，可以通过<code>$parent</code>和<code>$children</code>属性，分别得到当前组件的父组件和子组件实例</p>
<h2 id="slots和-scopedSlots"><a href="#slots和-scopedSlots" class="headerlink" title="$slots和$scopedSlots"></a><code>$slots</code>和<code>$scopedSlots</code></h2><p>后续章节讲解</p>
<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a><code>ref</code></h2><p>父组件可以通过<code>ref</code>获取到子组件的实例</p>
<h1 id="跨组件通信"><a href="#跨组件通信" class="headerlink" title="跨组件通信"></a>跨组件通信</h1><h2 id="Provide和Inject"><a href="#Provide和Inject" class="headerlink" title="Provide和Inject"></a><code>Provide</code>和<code>Inject</code></h2><p>示例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父级组件提供 &#x27;foo&#x27;</span></span><br><span class="line"><span class="keyword">var</span> Provider = &#123;</span><br><span class="line">  provide: &#123;</span><br><span class="line">    foo: <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件注入 &#x27;foo&#x27;</span></span><br><span class="line"><span class="keyword">var</span> Child = &#123;</span><br><span class="line">  inject: [<span class="string">&#x27;foo&#x27;</span>],</span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.foo) <span class="comment">// =&gt; &quot;bar&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>详见：<a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/api/#provide-inject">https://cn.vuejs.org/v2/api/?#provide-inject</a></p>
<h2 id="router"><a href="#router" class="headerlink" title="router"></a><code>router</code></h2><p>如果一个组件改变了地址栏，所有监听地址栏的组件都会做出相应反应</p>
<p>最常见的场景就是通过点击<code>router-link</code>组件改变了地址，<code>router-view</code>组件就渲染其他内容</p>
<h2 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a><code>vuex</code></h2><p>适用于大型项目的数据仓库</p>
<h2 id="store模式"><a href="#store模式" class="headerlink" title="store模式"></a><code>store</code>模式</h2><p>适用于中小型项目的数据仓库</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">const</span> store = &#123;</span><br><span class="line">  loginUser: ...,</span><br><span class="line">  setting: ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compA</span></span><br><span class="line"><span class="keyword">const</span> compA = &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      loginUser: store.loginUser</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compB</span></span><br><span class="line"><span class="keyword">const</span> compB = &#123;</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      setting: store.setting,</span><br><span class="line">      loginUser: store.loginUser</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="eventbus"><a href="#eventbus" class="headerlink" title="eventbus"></a><code>eventbus</code></h2><p>组件通知事件总线发生了某件事, 事件总线通知其他监听该事件的所有组件运行某个函数</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/21/%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/" data-id="ckxg6fvg300006sv7b68g2xc3" data-title="组件通信" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-vue响应式原理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/12/21/vue%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2021-12-21T13:48:43.885Z" itemprop="datePublished">2021-12-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>面试题：请阐述<code>vue2</code>响应式原理</p>
</blockquote>
<blockquote>
<p>vue官方阐述：<a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/guide/reactivity.html">https://cn.vuejs.org/v2/guide/reactivity.html</a></p>
</blockquote>
<p><strong>响应式数据的最终目标</strong>，是当对象本身或对象属性发生变化时，将会运行一些函数，最常见的就是render函数。</p>
<p>在具体实现上，vue用到了<strong>几个核心部件</strong>：</p>
<ol>
<li>Observer</li>
<li>Dep</li>
<li>Watcher</li>
<li>Scheduler</li>
</ol>
<h1 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h1><p>Observer要实现的目标非常简单，就是把一个普通的对象转换为响应式的对象</p>
<p>为了实现这一点，Observer把对象的每个属性通过<code>Object.defineProperty</code>转换为带有<code>getter</code>和<code>setter</code>的属性，这样一来，当访问或设置属性时，<code>vue</code>就有机会做一些别的事情。</p>
<img src="http://mdrs.yuanjin.tech/img/20210226153448.png" alt="image-20210226153448807" style="zoom:50%;" />

<p>Observer是vue内部的构造器，我们可以通过Vue提供的静态方法<code>Vue.observable( object )</code>间接的使用该功能。</p>
<p>在组件生命周期中，这件事发生在<code>beforeCreate</code>之后，<code>created</code>之前。</p>
<p>具体实现上，它会递归遍历对象的所有属性，以完成深度的属性转换。</p>
<p>由于遍历时只能遍历到对象的当前属性，因此无法监测到将来动态增加或删除的属性，因此<code>vue</code>提供了<code>$set</code>和<code>$delete</code>两个实例方法，让开发者通过这两个实例方法对已有响应式对象添加或删除属性。</p>
<p>对于数组，<code>vue</code>会更改它的隐式原型，之所以这样做，是因为vue需要监听那些可能改变数组内容的方法</p>
<img src="http://mdrs.yuanjin.tech/img/20210226154624.png" alt="image-20210226154624015" style="zoom:50%;" />

<p>总之，Observer的目标，就是要让一个对象，它属性的读取、赋值，内部数组的变化都要能够被vue感知到。</p>
<h1 id="Dep"><a href="#Dep" class="headerlink" title="Dep"></a>Dep</h1><p>这里有两个问题没解决，就是读取属性时要做什么事，而属性变化时要做什么事，这个问题需要依靠Dep来解决。</p>
<p>Dep的含义是<code>Dependency</code>，表示依赖的意思。</p>
<p><code>Vue</code>会为响应式对象中的每个属性、对象本身、数组本身创建一个<code>Dep</code>实例，每个<code>Dep</code>实例都有能力做以下两件事：</p>
<ul>
<li>记录依赖：是谁在用我</li>
<li>派发更新：我变了，我要通知那些用到我的人</li>
</ul>
<p>当读取响应式对象的某个属性时，它会进行依赖收集：有人用到了我</p>
<p>当改变某个属性时，它会派发更新：那些用我的人听好了，我变了</p>
<img src="http://mdrs.yuanjin.tech/img/20210226155852.png" alt="image-20210226155852964" style="zoom:50%;" />

<h1 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h1><p>这里又出现一个问题，就是Dep如何知道是谁在用我？</p>
<p>要解决这个问题，需要依靠另一个东西，就是Watcher。</p>
<p>当某个函数执行的过程中，用到了响应式数据，响应式数据是无法知道是哪个函数在用自己的</p>
<p>因此，vue通过一种巧妙的办法来解决这个问题</p>
<p>我们不要直接执行函数，而是把函数交给一个叫做watcher的东西去执行，watcher是一个对象，每个这样的函数执行时都应该创建一个watcher，通过watcher去执行</p>
<p>watcher会设置一个全局变量，让全局变量记录当前负责执行的watcher等于自己，然后再去执行函数，在函数的执行过程中，如果发生了依赖记录<code>dep.depend()</code>，那么<code>Dep</code>就会把这个全局变量记录下来，表示：有一个watcher用到了我这个属性</p>
<p>当Dep进行派发更新时，它会通知之前记录的所有watcher：我变了</p>
<img src="http://mdrs.yuanjin.tech/img/20210226161404.png" alt="image-20210226161404327" style="zoom:50%;" />

<p>每一个<code>vue</code>组件实例，都至少对应一个<code>watcher</code>，该<code>watcher</code>中记录了该组件的<code>render</code>函数。</p>
<p><code>watcher</code>首先会把<code>render</code>函数运行一次以收集依赖，于是那些在render中用到的响应式数据就会记录这个watcher。</p>
<p>当数据变化时，dep就会通知该watcher，而watcher将重新运行render函数，从而让界面重新渲染同时重新记录当前的依赖。</p>
<h1 id="Scheduler"><a href="#Scheduler" class="headerlink" title="Scheduler"></a>Scheduler</h1><p>现在还剩下最后一个问题，就是Dep通知watcher之后，如果watcher执行重运行对应的函数，就有可能导致函数频繁运行，从而导致效率低下</p>
<p>试想，如果一个交给watcher的函数，它里面用到了属性a、b、c、d，那么a、b、c、d属性都会记录依赖，于是下面的代码将触发4次更新：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">state.a = <span class="string">&quot;new data&quot;</span>;</span><br><span class="line">state.b = <span class="string">&quot;new data&quot;</span>;</span><br><span class="line">state.c = <span class="string">&quot;new data&quot;</span>;</span><br><span class="line">state.d = <span class="string">&quot;new data&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>这样显然是不合适的，因此，watcher收到派发更新的通知后，实际上不是立即执行对应函数，而是把自己交给一个叫调度器的东西</p>
<p>调度器维护一个执行队列，该队列同一个watcher仅会存在一次，队列中的watcher不是立即执行，它会通过一个叫做<code>nextTick</code>的工具方法，把这些需要执行的watcher放入到事件循环的微队列中，nextTick的具体做法是通过<code>Promise</code>完成的</p>
<blockquote>
<p>nextTick 通过 <code>this.$nextTick</code> 暴露给开发者</p>
<p>nextTick 的具体处理方式见：<a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/guide/reactivity.html#%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%98%9F%E5%88%97">https://cn.vuejs.org/v2/guide/reactivity.html#%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%98%9F%E5%88%97</a></p>
</blockquote>
<p>也就是说，当响应式数据变化时，<code>render</code>函数的执行是异步的，并且在微队列中</p>
<h1 id="总体流程"><a href="#总体流程" class="headerlink" title="总体流程"></a>总体流程</h1><p><img src="http://mdrs.yuanjin.tech/img/20210226163936.png" alt="image-20210226163936839"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/21/vue%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/" data-id="ckxg5ysky000084v7axlg74rv" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-事件循环" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/04/04/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/" class="article-date">
  <time class="dt-published" datetime="2021-04-04T08:16:35.000Z" itemprop="datePublished">2021-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/04/04/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/">事件循环</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="执行顺序从上倒下"><a href="#执行顺序从上倒下" class="headerlink" title="执行顺序从上倒下"></a>执行顺序从上倒下</h3><h3 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h3><p>………………</p>
<h3 id="微队列"><a href="#微队列" class="headerlink" title="微队列"></a>微队列</h3><p>promise、$nextTick</p>
<h3 id="宏队列"><a href="#宏队列" class="headerlink" title="宏队列"></a>宏队列</h3><p>setTimeout</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/04/04/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/" data-id="ckn2wa2i70000csv71qezezg4" data-title="事件循环" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-typescrpt的学习" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/02/19/typescrpt%E7%9A%84%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2021-02-19T13:07:29.000Z" itemprop="datePublished">2021-02-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/02/19/typescrpt%E7%9A%84%E5%AD%A6%E4%B9%A0/">typescrpt的学习</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="typescrpt的学习"><a href="#typescrpt的学习" class="headerlink" title="typescrpt的学习"></a>typescrpt的学习</h2><h3 id="2-19"><a href="#2-19" class="headerlink" title="2/19"></a>2/19</h3><p>&emsp;这两天都在学习typescript,以为这个课程资料十分详细，那就附上链接吧<br>&emsp;<a target="_blank" rel="noopener" href="http://docs.vikingship.xyz/typescript.html" title="ts笔记">ts笔记</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/19/typescrpt%E7%9A%84%E5%AD%A6%E4%B9%A0/" data-id="cklcbblje0000qgv74ocv45qk" data-title="typescrpt的学习" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-封装promis" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/02/14/%E5%B0%81%E8%A3%85promis/" class="article-date">
  <time class="dt-published" datetime="2021-02-14T08:45:39.000Z" itemprop="datePublished">2021-02-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/02/14/%E5%B0%81%E8%A3%85promis/">封装promis</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="2-14"><a href="#2-14" class="headerlink" title="2/14"></a>2/14</h2><h4 id="下面是代码"><a href="#下面是代码" class="headerlink" title="下面是代码"></a>下面是代码</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myPromise</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">typeof</span> fn !== <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">`Promise resolver <span class="subst">$&#123;fn&#125;</span> is not a function`</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">this</span>.status = <span class="string">&#x27;pending&#x27;</span>;</span><br><span class="line">      <span class="built_in">this</span>.data = <span class="literal">null</span>;</span><br><span class="line">      <span class="built_in">this</span>.resolveArr = [];</span><br><span class="line">      <span class="built_in">this</span>.rejectArr = [];</span><br><span class="line">      <span class="keyword">var</span> self = <span class="built_in">this</span></span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(self.status == <span class="string">&#x27;pending&#x27;</span>) &#123;</span><br><span class="line">            self.status = <span class="string">&#x27;resolved&#x27;</span>;</span><br><span class="line">            self.data = data;</span><br><span class="line">            self.resolveArr.forEach(<span class="function"><span class="params">fn</span>=&gt;</span>fn());</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,<span class="number">0</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(self.status == <span class="string">&#x27;pending&#x27;</span>)&#123;</span><br><span class="line">            self.status = <span class="string">&#x27;rejected&#x27;</span>;</span><br><span class="line">            self.data = data;</span><br><span class="line">            self.rejectArr.forEach(<span class="function"><span class="params">fn</span>=&gt;</span>fn());</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,<span class="number">0</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      fn(resolve,reject)</span><br><span class="line">    &#125;</span><br><span class="line">    myPromise.prototype.then = <span class="function"><span class="keyword">function</span> (<span class="params">onResolve,onReject</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.status == <span class="string">&#x27;resolved&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> res = onResolve(self.data);</span><br><span class="line">          <span class="keyword">if</span>(res <span class="keyword">instanceof</span> myPromise)&#123;</span><br><span class="line">            res.then(resolve,reject)</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resolve(res)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.status == <span class="string">&#x27;rejected&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> res = onReject(self.data);</span><br><span class="line">          <span class="keyword">if</span>(res <span class="keyword">instanceof</span> myPromise)&#123;</span><br><span class="line">            res.then(resolve,reject)</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resolve(res)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">this</span>.status == <span class="string">&#x27;pending&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">          self.resolveArr.push((<span class="function"><span class="keyword">function</span> (<span class="params">onResolve</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">              <span class="keyword">var</span> res = onResolve(self.data);</span><br><span class="line">              <span class="keyword">if</span>(res <span class="keyword">instanceof</span> myPromise)&#123;</span><br><span class="line">                res.then(resolve,reject)</span><br><span class="line">              &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                resolve(res)</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;&#125;)(onResolve))</span><br><span class="line">          self.rejectArr.push((<span class="function"><span class="keyword">function</span> (<span class="params">onReject</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">              <span class="keyword">var</span> res = onReject(self.data);</span><br><span class="line">              <span class="keyword">if</span>(res <span class="keyword">instanceof</span> myPromise)&#123;</span><br><span class="line">                res.then(resolve,reject)</span><br><span class="line">              &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                resolve(res)</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;&#125;)(onReject))</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// var p = new myPromise((resolve, reject) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//   setTimeout(function ()&#123;</span></span><br><span class="line">    <span class="comment">//     resolve(1121)</span></span><br><span class="line">    <span class="comment">//   &#125;,3000)</span></span><br><span class="line">    <span class="comment">//   setTimeout(function ()&#123;</span></span><br><span class="line">    <span class="comment">//     reject(2221)</span></span><br><span class="line">    <span class="comment">//   &#125;,1000)</span></span><br><span class="line">    <span class="comment">// &#125;);</span></span><br><span class="line">    <span class="keyword">var</span> p = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      resolve(<span class="number">1</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">    p.then(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data),<span class="function"><span class="params">err</span>=&gt;</span><span class="built_in">console</span>.log(err))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">    <span class="comment">//resolve 中的settimeout可以把函数放到队列最后执行</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// p.then(data=&gt;new myPromise((resolve, reject) =&gt; &#123;reject(&#x27;hhh&#x27; +data)&#125;),err=&gt;err)</span></span><br><span class="line">    <span class="comment">//   .then(data=&gt;console.log(data + &#x27;sec&#x27;),err=&gt;console.log(err + &#x27;err&#x27;))</span></span><br></pre></td></tr></table></figure>
<h4 id="简述下过程"><a href="#简述下过程" class="headerlink" title="简述下过程"></a>简述下过程</h4><p>1、写一个myPromise的构造函数<br>2、在myPromise.prototype 上写then方法<br>3、因为异步的问题，需要把在 status == ‘pending’ 的时候把待执行的函数push到resolveArr中（这里还用闭包存储onResolve）<br>在resolve中用forEach调用resolveArr中的函数<br>4、还有一个执行顺序的问题：resolve 中的settimeout可以把函数放到队列最后执行 =&gt; resolve最后执行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/14/%E5%B0%81%E8%A3%85promis/" data-id="ckl4wycrh0000aov78ujebjj4" data-title="封装promis" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ES6-learn2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/02/13/ES6-learn2/" class="article-date">
  <time class="dt-published" datetime="2021-02-13T13:09:25.000Z" itemprop="datePublished">2021-02-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/02/13/ES6-learn2/">ES6-learn2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="class-和-promise"><a href="#class-和-promise" class="headerlink" title="class 和 promise"></a>class 和 promise</h2><h4 id="1、class"><a href="#1、class" class="headerlink" title="1、class"></a>1、class</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;cx&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.date = <span class="string">&#x27;21/2/13&#x27;</span>;</span><br><span class="line">    <span class="comment">// this.printFn = this.printFn.bind(this); //法一 ： bind</span></span><br><span class="line">    <span class="built_in">this</span>.printFn = <span class="function">()=&gt;</span>&#123;<span class="built_in">this</span>.getMes(<span class="string">` is happy <span class="subst">$&#123;<span class="built_in">this</span>.date&#125;</span>`</span>)&#125;  </span><br><span class="line">    <span class="comment">//法二 ： 箭头函数 这里的this指向Person里</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">getMes</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name + data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">var</span> &#123;printFn&#125; = p;  <span class="comment">//解构赋值 =》 &#123;printFn:printFn&#125;</span></span><br><span class="line"><span class="comment">//会报错 因为this不能指向Person的</span></span><br><span class="line"><span class="comment">//解决方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name = <span class="string">&#x27;cgc&#x27;</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">fn1</span>(<span class="params">date = <span class="string">&#x27;father&#x27;</span></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;111  &#x27;</span>+ date);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(<span class="string">&#x27;cx&#x27;</span>);    <span class="comment">//super是调用父类的constructor</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">fn2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">super</span>.fn1(<span class="string">&#x27;baby&#x27;</span>)  <span class="comment">//super 找的是父类原型对象  =&gt;   A.prototype</span></span><br><span class="line">    <span class="comment">//console.log(super.name); // undefined</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> A()</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> B()</span><br><span class="line"><span class="comment">// 子类 __proto__ 表示构造函数的继承</span></span><br><span class="line"><span class="comment">// 子类 __proto__.prototype 表示方法的继承</span></span><br><span class="line"><span class="built_in">console</span>.log(A == B.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(A.prototype == B.__proto__.prototype);</span><br></pre></td></tr></table></figure>
<h4 id="2、promise"><a href="#2、promise" class="headerlink" title="2、promise"></a>2、promise</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//三个阶段</span></span><br><span class="line"><span class="comment">// pending 就绪状态</span></span><br><span class="line"><span class="comment">// resolved 成功状态</span></span><br><span class="line"><span class="comment">// rejected 失败状态</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> num = <span class="built_in">Math</span>.random() * <span class="number">100</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num&gt;<span class="number">20</span>)&#123;</span><br><span class="line">      resolve(num)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      reject(<span class="string">&#x27;太大了要不起&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="built_in">Math</span>.random()*<span class="number">5000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// p.then(data=&gt;console.log(data),err=&gt;console.log(err));</span></span><br><span class="line"><span class="comment">// p.then(data=&gt;data,err=&gt;err).then(data=&gt;console.log(data + &#x27;sec&#x27;),err=&gt;console.log(err + &#x27;err&#x27;)) //常量一定调用的前面一个</span></span><br><span class="line">p.then(<span class="function"><span class="params">data</span>=&gt;</span><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;reject(<span class="string">&#x27;hhh&#x27;</span>)&#125;),<span class="function"><span class="params">err</span>=&gt;</span>err)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data + <span class="string">&#x27;sec&#x27;</span>),<span class="function"><span class="params">err</span>=&gt;</span><span class="built_in">console</span>.log(err + <span class="string">&#x27;err&#x27;</span>)); <span class="comment">//这个链式调用 由返回的promise中的resolve/reject 决定</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> num = <span class="built_in">Math</span>.random() * <span class="number">100</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num&gt;<span class="number">20</span>)&#123;</span><br><span class="line">      resolve(num)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      reject(<span class="string">&#x27;太大了要不起&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="built_in">Math</span>.random()*<span class="number">5000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> num = <span class="built_in">Math</span>.random() * <span class="number">100</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num&gt;<span class="number">20</span>)&#123;</span><br><span class="line">      resolve(num)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      reject(<span class="string">&#x27;太大了要不起&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="built_in">Math</span>.random()*<span class="number">5000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// Promise.all</span></span><br><span class="line"><span class="built_in">Promise</span>.all([p,p1,p2]).then(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data),<span class="function"><span class="params">err</span>=&gt;</span><span class="built_in">console</span>.log(err))</span><br><span class="line"><span class="comment">//全部成功才调用第一个函数返回数组。 有一个失败就失败的那个调用第二个err的箭头函数</span></span><br><span class="line"><span class="comment">// Promise.race</span></span><br><span class="line"><span class="built_in">Promise</span>.race([p,p1,p2]).then(<span class="function"><span class="params">data</span>=&gt;</span><span class="built_in">console</span>.log(data))</span><br><span class="line"><span class="comment">//只会反回第一个成功的 通常不用err</span></span><br></pre></td></tr></table></figure>
<hr>
<p>基于Promise是封装的imgLoad</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loadUrl = <span class="function"><span class="params">url</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">  img.src = url;</span><br><span class="line">  img.onload = <span class="function">()=&gt;</span>resolve(img);</span><br><span class="line">  img.onerror = <span class="function">()=&gt;</span>reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;can not load image at &#x27;</span>+url));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p>基于Promise是封装的Ajax</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myAjax = <span class="function">(<span class="params">data = &#123;&#125;,url,type = <span class="string">&#x27;GEt&#x27;</span></span>) =&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">      url,</span><br><span class="line">      data,</span><br><span class="line">      type,</span><br><span class="line">      success:<span class="function"><span class="params">data</span> =&gt;</span> resolve(data),</span><br><span class="line">      error:<span class="function"><span class="params">err</span> =&gt;</span> reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/13/ES6-learn2/" data-id="ckl3qs4qj0000ggv7hrf6fehf" data-title="ES6-learn2" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ES6-learn1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/02/10/ES6-learn1/" class="article-date">
  <time class="dt-published" datetime="2021-02-10T11:02:03.000Z" itemprop="datePublished">2021-02-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/02/10/ES6-learn1/">ES6-learn1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="2-10"><a href="#2-10" class="headerlink" title="2/10"></a>2/10</h2><h4 id="下面是整理的代码"><a href="#下面是整理的代码" class="headerlink" title="下面是整理的代码"></a>下面是整理的代码</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// let 和 var  </span></span><br><span class="line"> <span class="comment">//解构赋值  </span></span><br><span class="line"> <span class="keyword">var</span> &#123;a,b,c&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>&#125;;  </span><br><span class="line"> <span class="keyword">var</span> [d,e,f] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];  </span><br><span class="line"> <span class="comment">//解构赋值的默认值  </span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">&#123;a1=<span class="number">2</span>,a2=<span class="number">11</span>&#125; = &#123;&#125;</span>)</span>&#123;  </span><br><span class="line">   <span class="built_in">console</span>.log(a1,a2);  </span><br><span class="line"> &#125;  </span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params">&#123;a1,a2&#125; = &#123;a1:<span class="number">11</span>,a2:<span class="number">14</span>&#125;</span>)</span>&#123;  </span><br><span class="line">   <span class="built_in">console</span>.log(a1,a2);  </span><br><span class="line"> &#125;  </span><br><span class="line"> fn(&#123;&#125;)  </span><br><span class="line"> fn2()  </span><br><span class="line"> fn(&#123;<span class="attr">a1</span>:<span class="number">11</span>,<span class="attr">a2</span>:<span class="number">3</span>&#125;)  </span><br><span class="line"> fn2(&#123;<span class="attr">a1</span>:<span class="number">11</span>,<span class="attr">a2</span>:<span class="number">3</span>&#125;)  </span><br><span class="line"> <span class="comment">//字符串的拓展  </span></span><br><span class="line"> <span class="keyword">let</span> age = <span class="number">18</span>,x=<span class="number">2</span>,y=<span class="number">1</span>,arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];  </span><br><span class="line"> <span class="keyword">let</span> str = <span class="string">`  </span></span><br><span class="line"><span class="string"> &lt;div&gt;name:cx&lt;/div&gt;      //可换行   </span></span><br><span class="line"><span class="string"> &lt;div&gt;<span class="subst">$&#123;age&#125;</span>&lt;/div&gt;       //可添加变量  </span></span><br><span class="line"><span class="string"> &lt;div&gt;<span class="subst">$&#123;x+y&#125;</span>&lt;/div&gt;       //可计算 1 + 2 = 3  </span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;arr.map(<span class="keyword">function</span> (ele,index)&#123;  </span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="keyword">return</span>  <span class="string">`<span class="subst">$&#123;ele&#125;</span>:<span class="subst">$&#123;index&#125;</span>`</span>  </span></span></span><br><span class="line"><span class="string"><span class="subst"> &#125;)&#125;</span>                     //还可以写函数，嵌套  </span></span><br><span class="line"><span class="string"> `</span>  </span><br><span class="line"> <span class="comment">//标签模板 ———— 函数调用的特殊形式  </span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn3</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">   <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);  </span><br><span class="line"> &#125;  </span><br><span class="line"> fn3<span class="string">`cx<span class="subst">$&#123;age&#125;</span>cx<span class="subst">$&#123;y&#125;</span>`</span>  </span><br><span class="line"> <span class="comment">//标签模板的一个实例，防&lt;script&gt;注入  </span></span><br><span class="line"> <span class="keyword">let</span> userName = <span class="string">&#x27;&lt;script&gt;cx&lt;\/script&gt;&#x27;</span>;  </span><br><span class="line"> <span class="keyword">let</span> safestr = safeStr<span class="string">`&lt;p&gt;<span class="subst">$&#123;userName&#125;</span>&lt;\/p&gt;`</span>;  </span><br><span class="line"> name1.innerHTML = safestr;  </span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">safeStr</span>(<span class="params">data</span>)</span>&#123;  </span><br><span class="line">   <span class="keyword">let</span> str = data[<span class="number">0</span>];  </span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>;i &lt; <span class="built_in">arguments</span>.length;i ++)&#123;  </span><br><span class="line">     str += <span class="built_in">arguments</span>[i].replace(<span class="regexp">/&amp;/g</span>,<span class="string">&#x27;&amp;amp;&#x27;</span>).replace(<span class="regexp">/&lt;/g</span>,<span class="string">&#x27;&amp;lt;&#x27;</span>).replace(<span class="regexp">/&gt;/g</span>,<span class="string">&#x27;&amp;gt&#x27;</span>);  </span><br><span class="line">     str += data[i]  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> str;  </span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line"> <span class="comment">//函数参数的默认值</span></span><br><span class="line"> <span class="comment">//  就是当undefined的时候使用默认值</span></span><br><span class="line"> <span class="comment">//  注意，当使用默认值的时候是用的let ，let是不能重复声明的</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params">age=<span class="number">18</span></span>)</span>&#123;</span><br><span class="line">   <span class="comment">// let age = 40      直接会报错</span></span><br><span class="line">   <span class="built_in">console</span>.log(age);</span><br><span class="line"> &#125;</span><br><span class="line"> getAge(<span class="literal">null</span>) <span class="comment">//null</span></span><br><span class="line"> getAge(<span class="literal">false</span>) <span class="comment">//false</span></span><br><span class="line"> getAge() <span class="comment">//18</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//扩展运算符</span></span><br><span class="line"> <span class="comment">//..arg 获取函数中多以的参数</span></span><br><span class="line"> <span class="comment">//用起来相当于去括号</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn4</span>(<span class="params">...arg</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(arg);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">let</span> arr2 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"> fn4.call(<span class="literal">null</span>,...arr2)</span><br><span class="line"> fn4.apply(<span class="literal">null</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"> <span class="comment">//箭头函数</span></span><br><span class="line"> <span class="comment">//箭头函数中的this指的是上一级，而不是谁调用指向谁了。</span></span><br><span class="line"> <span class="comment">//箭头函数不能使用argument</span></span><br><span class="line"> <span class="keyword">let</span> obj = &#123;</span><br><span class="line">   fun1:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">   &#125;,</span><br><span class="line">   fun2:<span class="function">()=&gt;</span><span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> obj.fun1() <span class="comment">//obj</span></span><br><span class="line"> obj.fun2() <span class="comment">//windows</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/10/ES6-learn1/" data-id="ckl3qv4dc0000f8v74zk86fin" data-title="ES6-learn1" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-video和audio" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2021/02/04/video%E5%92%8Caudio/" class="article-date">
  <time class="dt-published" datetime="2021-02-04T14:11:24.000Z" itemprop="datePublished">2021-02-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2021/02/04/video%E5%92%8Caudio/">video和audio</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="21-2-4"><a href="#21-2-4" class="headerlink" title="21/2/4"></a>21/2/4</h1><h4 id="今天学了audio-和-video-ppt见"><a href="#今天学了audio-和-video-ppt见" class="headerlink" title="今天学了audio 和 video.ppt见."></a>今天学了audio 和 video.ppt见.</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/04/video%E5%92%8Caudio/" data-id="ckkqxwsev0000owv7hz1leopt" data-title="video和audio" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="extend next" rel="next" href="/blog/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/02/">February 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2021/12/21/v-model/">v-model</a>
          </li>
        
          <li>
            <a href="/blog/2021/12/21/%E8%99%9A%E6%8B%9Fdom%E8%AF%A6%E8%A7%A3/">虚拟dom详解</a>
          </li>
        
          <li>
            <a href="/blog/2021/12/21/%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/">组件通信</a>
          </li>
        
          <li>
            <a href="/blog/2021/12/21/vue%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2021/04/04/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/">事件循环</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/blog/js/jquery-3.4.1.min.js"></script>



  
<script src="/blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/blog/js/script.js"></script>





  </div>
</body>
</html>